#!/bin/sh
# build server projects generated by java-petstore-server-all.sh 
# run it from swagger-codegen base directory

red=`tput setaf 1`
green=`tput setaf 2`
reset_clr=`tput sgr0`

declare -a projects=( \
 java-inflector \
 java-msf4j \
 java-vertx/async java-vertx/rx \
 jaxrs/jersey1 jaxrs/jersey1-useTags jaxrs/jersey2 jaxrs/jersey2-useTags \
 jaxrs-cxf \
 jaxrs-cxf-annotated-base-path \
 jaxrs-cxf-cdi \
 jaxrs-cxf-non-spring-app \
 jaxrs-resteasy/eap jaxrs-resteasy/eap-java8 jaxrs-resteasy/eap-joda jaxrs-resteasy/joda jaxrs-resteasy/default \
 jaxrs-spec \
 jaxrs-spec-interface \
 spring-mvc \
 spring-mvc-j8-async \
 springboot \
 springboot-beanvalidation \
 springboot-implicitHeaders \
 springboot-useoptional \
 undertow \
)

echo Build java petstore server projects..

base_dir=`pwd`

for i in "${projects[@]}"
do
  proj_dir=$base_dir/samples/server/petstore/$i
  if [ -d "$proj_dir" ]; then
    cd $proj_dir
       mvn package > ./build.log
    if [ $? = 0 ]; then
      echo "  $i - ${green}SUCCEED${reset_clr}"
    else
      echo "  $i - ${red}FAILED${reset_clr}"
    fi
    mvn clean &>/dev/null
  else 
     echo ${red}project not found:${reset_clr} $proj_dir
  fi
done
